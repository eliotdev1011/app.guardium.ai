import{r as o,j as a,d as D,h as O,c as L}from"./index-NBfXeSsy.js";import{V as v}from"./vpnService.http-e0Cr0eu7.js";const x=({defaultValue:r,value:f,options:d,onChange:h})=>{const[m,e]=o.useState(!1),p=s=>{h&&h(s),e(!1)};return o.useEffect(()=>{const s=()=>e(!1);return window.addEventListener("click",s),()=>window.removeEventListener("click",s)},[]),a.jsxs("div",{onClick:s=>s.stopPropagation(),className:"select",children:[a.jsxs("div",{className:"selectInput",onClick:()=>e(!m),children:[a.jsx("span",{children:f||r||"Select an option"}),a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:`arrow ${m?"open":""}`,children:a.jsx("path",{d:"M7.41 8.59L6 10L12 16L18 10L16.59 8.59L12 13.17L7.41 8.59Z",fill:"#D0D0D0"})})]}),m&&a.jsx("div",{className:"selectOptions",children:d==null?void 0:d.map(s=>a.jsx("div",{className:"option",onClick:()=>p(s),children:s.value},s.id))})]})},U=()=>{const{t:r}=D(),[f,d]=o.useState(!1),[h,m]=o.useState(!1),[e,p]=o.useState(null),[s,w]=o.useState(null),[t,N]=o.useState(null),[g,C]=o.useState(null),[l,b]=o.useState();O(!1);const k=n=>{const i=n.ports.data.map(c=>({id:c.id,value:c.protocol+"-"+c.number})),u=n.servers.data.map(c=>({id:c.id,value:c.city}));return{ports:i,servers:u}};o.useEffect(()=>{v.getServersAndPorts().then(n=>{const i=k(n.data);b(i),N(i.ports[0]),C(i.ports[0]),p(i.servers[0]),w(i.servers[0])}).catch(n=>{console.log(n)})},[]);const y=(n,i="openWPN")=>{const u=document.createElement("a"),c=new Blob([n],{type:"text/plain"});u.href=URL.createObjectURL(c);let j=null;i==="openWPN"&&(e!=null&&e.value)&&(t!=null&&t.value)&&(s!=null&&s.value)?j=`config-${e.value}-${t.value}.ovpn`:j=`config-${s==null?void 0:s.value}.conf`,u.download=j,document.body.appendChild(u),u.click(),document.body.removeChild(u)},E=async()=>{d(!0);try{if(!(e!=null&&e.id)||!(t!=null&&t.id))return;const n=await v.getConfigFile(e==null?void 0:e.id,t==null?void 0:t.id);y(n.data,"openWPN")}catch(n){console.log(n)}finally{d(!1)}},V=async()=>{m(!0);try{if(!(e!=null&&e.id))return;const n=await v.getWireGuardConfigFile(e==null?void 0:e.id);y(n.data,"wireGuard")}catch(n){console.log(n)}finally{m(!1)}};return a.jsx("div",{className:"VpnConfig",children:a.jsxs("div",{children:[a.jsx("h4",{children:r("CreateYourOpenVPN")}),a.jsxs("div",{className:"d-flex flex-column w-100 flex-md-row justify-content-between",children:[a.jsxs("div",{className:"selectGroup",children:[a.jsx("div",{className:"mr-4",children:a.jsx(x,{options:l==null?void 0:l.servers,onChange:n=>{p(n)},defaultValue:"Amsterdam",value:e==null?void 0:e.value})}),a.jsx("div",{className:"mx-md-4 mt-3 mt-md-0",children:a.jsx(x,{onChange:n=>{N(n)},options:l==null?void 0:l.ports,value:t==null?void 0:t.value,defaultValue:"UDP - 53"})})]}),a.jsx(L,{loading:f,onClick:E,className:"btn btn-green w-100 m-md-auto  mt-3 mt-md-0",children:r("generate")})]}),a.jsx("h4",{className:"mt-4",children:r("CreateYourWireguard")}),a.jsxs("div",{className:"d-flex flex-column flex-md-row ",children:[a.jsxs("div",{className:"selectGroup",children:[a.jsx("div",{className:"mr-4",children:a.jsx(x,{options:l==null?void 0:l.servers,onChange:n=>{w(n)},defaultValue:"Amsterdam",value:s==null?void 0:s.value})}),a.jsx("div",{style:{opacity:0,cursor:"inherit"},className:"mx-md-4 mt-3 mt-md-0 withoutCursor",children:a.jsx(x,{onChange:n=>{console.log(n),C(n)},options:l==null?void 0:l.ports,value:g==null?void 0:g.value,defaultValue:"UDP - 53"})})]}),a.jsx(L,{loading:h,onClick:V,className:"btn btn-green w-100 m-md-auto mt-3 mt-md-0",children:r("generate")})]})]})})};export{U as default};
